# Changelog

Все значимые изменения проекта фиксируются в этом файле.

## [0.1.4] - 2026-03-01

### New
- Добавлен надежный fallback прогресса экспорта, чтобы индикатор не зависал на `0%` до самого завершения в некоторых окружениях FFmpeg.
- Добавлена поддержка отмены экспорта (`cancel_export`) с корректным завершением процесса ffmpeg и итоговым статусом `Export cancelled`.
- В UI экспорта добавлены индикаторы `ETA`/`Elapsed` и более точное отображение прогресса (`x.y%`).
- Для экспорта внедрено адаптивное motion-aware прореживание точек камеры и курсора (детализация растет с длительностью проекта, повороты и ускорения сохраняются лучше).
- Добавлен переключатель на оверлей-плашке записи для временного скрытия курсора.
- Интервалы скрытого курсора теперь сохраняются в проект и применяются в `Edit`-предпросмотре и в экспорте.
- На интервалах скрытого курсора отключается автозум (клики в эти периоды не создают авто-зум сегменты).
- Экран `Export` запоминает последнюю выбранную папку назначения между запусками приложения.
- Значение FPS по умолчанию для экспорта изменено на `60`.
- Добавлена защита от потери правок: при несохраненных изменениях в `Edit` перед переходом на `Record`/`Export` или закрытием приложения показывается диалог `Сохранить изменения?` (`Да`/`Нет`/`Отмена`).

### Fixed
- Исправлена деградация экспорта на длинных видео: зумы и курсор больше не становятся дерганными из-за переупрощения траекторий.
- Исправлена ошибка предпросмотра в редакторе `Failed to play video: AbortError`.
- Убрана гонка между `video.play()` и `video.pause()` при быстрых переключениях воспроизведения.
- Добавлена защита от устаревших `play()`-запросов при смене источника/состояния плеера.
- Ожидаемые браузерные `AbortError` больше не показываются как пользовательская ошибка.
- Исправлена кнопка закрытия приложения в кастомной верхней панели.
- Исправлено переопределение FPS в `Export` из старых настроек проекта: значение по умолчанию стабильно `60`.

## [0.1.3] - 2026-02-23

### Fixed
- Исправлен режим триггера автозума `1 клик`: клики больше не теряются из-за дефолтной кластеризации и большого `min_zoom_interval`.
- Для режимов `1 клик` и `Ctrl+клик` ослаблены внутренние debounce/cluster-ограничения, чтобы камера реагировала почти на каждый валидный клик.
- Исправлен кейс no-op переходов в строгих click-режимах: если семантическая цель дает `1x`, применяется fallback-зум от точки клика.
- В strict click-режимах отключено подавление ретаргета через safe-zone, из-за которого часть кликов раньше не меняла фокус.

## [0.1.2] - 2026-02-23

### Fixed
- Исправлен скролл в `LockedFocus`: сдвиг камеры теперь считается в корректной размерности (с учетом размеров экрана и текущего зума), без резких скачков.
- Исправлен `phantom escape` в `LockedFocus`: выход из фокуса теперь проверяется по выходу курсора за текущий viewport камеры, а не по простой дистанции до центра.
- Исправлено игнорирование быстрых кликов в автозуме: переходы больше не отбрасываются по `min_zoom_interval_ms`, а откладываются по времени старта.
- Исправлено дрожание на hard-edge панорамировании: шаг камеры ограничен фактическим пробоем границы.
- Сегменты зума на таймлайне синхронизированы с реальным движением spring-камеры (визуальные начало/конец лучше совпадают с фактическим зумом).
- Исправлено отображение времени на таймлайне: расчет ведется по реальной ширине lane (без колонки labels), устранен постоянный сдвиг playhead/сегментов.
- Усилены ограничения перетаскивания сегментов: добавлены neighbor-aware границы и минимальный зазор, чтобы сегменты не пересекались.
- Стабилизирована отрисовка сегментов при большом zoom таймлайна: соседние сегменты больше не тянут друг друга при редактировании границ.
- Добавлен единый тайминг-сдвиг курсора в предпросмотре и экспорте, чтобы уменьшить визуальное отставание курсора.

## [0.1.1] - 2026-02-22

### Fixed
- Исправлено появление окна терминала в release-сборке при запуске внешних процессов (`ffmpeg` / `powershell`) в сценариях:
  - открытие вкладки `Record` (предпросмотр/детект аудио),
  - постобработка после `Stop`,
  - `Export`.
